<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Arkeo Data Marketplace</title>
  <link rel="icon" type="image/png" href="images/arkeo-logo-200px_1.png">
  <meta name="description" content="Decentralized RPC infrastructure marketplace. Connect to blockchain data providers with pay-as-you-go pricing.">
  <meta name="theme-color" content="#0a0c10">
  <!-- Open Graph -->
  <meta property="og:title" content="Arkeo Data Marketplace">
  <meta property="og:description" content="Decentralized RPC infrastructure. No signup. No KYC. Just connect and query.">
  <meta property="og:type" content="website">
  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="js/config.js"></script>
  <script src="js/utils.js"></script>
  <style>
    :root {
      --bg-main: #0a0c10;
      --bg-card: #12151c;
      --bg-card-hover: #181c25;
      --bg-input: #1a1f2a;
      --border: #252a36;
      --border-hover: #3BE0FF;
      --arkeo: #3BE0FF;
      --arkeo-dim: rgba(59, 224, 255, 0.1);
      --arkeo-glow: rgba(59, 224, 255, 0.3);
      --success: #10b981;
      --warning: #f59e0b;
      --error: #ef4444;
      --text: #ffffff;
      --text-dim: #8b92a5;
      --text-muted: #5a6278;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background: var(--bg-main);
      color: var(--text);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Inter', sans-serif;
      line-height: 1.6;
      min-height: 100vh;
    }

    /* Navigation */
    .nav {
      background: var(--bg-card);
      border-bottom: 1px solid var(--border);
      padding: 1rem 2rem;
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .nav-inner {
      max-width: 1400px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .logo {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-size: 1.25rem;
      font-weight: 700;
      text-decoration: none;
      color: var(--text);
    }
    .logo img { height: 40px; }
    .logo-text span { color: var(--arkeo); }
    
    .nav-links {
      display: flex;
      align-items: center;
      gap: 2rem;
    }
    .nav-link {
      color: var(--text-dim);
      text-decoration: none;
      font-weight: 500;
      transition: color 0.2s;
    }
    .nav-link:hover { color: var(--arkeo); }
    .nav-link.active { color: var(--arkeo); }

    .btn {
      padding: 0.75rem 1.5rem;
      border-radius: 0.5rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      border: none;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }
    .btn-primary {
      background: var(--arkeo);
      color: #000;
    }
    .btn-primary:hover {
      box-shadow: 0 0 20px var(--arkeo-glow);
    }
    .btn-secondary {
      background: var(--bg-input);
      color: var(--text);
      border: 1px solid var(--border);
    }
    .btn-secondary:hover {
      border-color: var(--arkeo);
      color: var(--arkeo);
    }
    .btn-outline {
      background: transparent;
      color: var(--arkeo);
      border: 1px solid var(--arkeo);
    }
    .btn-outline:hover {
      background: var(--arkeo-dim);
    }
    .btn-buy {
      background: linear-gradient(135deg, #f59e0b, #d97706);
      color: #000;
      font-weight: 600;
    }
    .btn-buy:hover {
      box-shadow: 0 0 20px rgba(245, 158, 11, 0.4);
    }
    .btn-provide,
    .btn-use {
      background: linear-gradient(90deg, #ff2bcb 0%, #ff4fd2 50%, #ff8a2b 100%);
      color: #fff;
      font-weight: 600;
      border: none;
    }
    .btn-provide:hover,
    .btn-use:hover {
      filter: brightness(1.05);
      box-shadow: 0 10px 30px rgba(255, 79, 210, 0.25);
    }
    .nav-buttons {
      display: flex;
      gap: 0.75rem;
      align-items: center;
    }

    /* Hero Section */
    .hero {
      text-align: center;
      padding: 4rem 2rem;
      background: linear-gradient(180deg, var(--bg-card) 0%, var(--bg-main) 100%);
      border-bottom: 1px solid var(--border);
    }
    .hero h1 {
      font-size: 3rem;
      font-weight: 700;
      margin-bottom: 1rem;
      background: linear-gradient(135deg, var(--text) 0%, var(--arkeo) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .hero p {
      font-size: 1.25rem;
      color: var(--text-dim);
      max-width: 600px;
      margin: 0 auto 2rem;
    }
    .hero-buttons {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    /* Stats Bar */
    .stats-bar {
      background: var(--bg-card);
      border-bottom: 1px solid var(--border);
      padding: 1.5rem 2rem;
    }
    .stats-inner {
      max-width: 1400px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 2rem;
    }
    .stat {
      text-align: center;
    }
    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      color: var(--arkeo);
    }
    .stat-label {
      font-size: 0.875rem;
      color: var(--text-dim);
      margin-top: 0.25rem;
    }

    /* Main Content */
    .main {
      max-width: 1400px;
      margin: 0 auto;
      padding: 2rem;
    }

    /* Section Headers */
    .section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1.5rem;
    }
    .section-title {
      font-size: 1.5rem;
      font-weight: 600;
    }

    /* Filters */
    .filters {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
    }
    .filter-input {
      padding: 0.75rem 1rem;
      border-radius: 0.5rem;
      border: 1px solid var(--border);
      background: var(--bg-input);
      color: var(--text);
      min-width: 200px;
    }
    .filter-input:focus {
      outline: none;
      border-color: var(--arkeo);
    }
    .filter-select {
      padding: 0.75rem 1rem;
      border-radius: 0.5rem;
      border: 1px solid var(--border);
      background: var(--bg-input);
      color: var(--text);
      cursor: pointer;
    }

    /* Provider Grid */
    .provider-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 1.5rem;
    }

    /* Provider Card */
    .provider-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 1rem;
      padding: 1.5rem;
      transition: all 0.2s;
    }
    .provider-card:hover {
      border-color: var(--arkeo);
      background: var(--bg-card-hover);
      transform: translateY(-2px);
    }
    .provider-header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      margin-bottom: 1rem;
    }
    .provider-name {
      font-size: 1.125rem;
      font-weight: 600;
      margin-bottom: 0.25rem;
    }
    .provider-service {
      font-size: 0.875rem;
      color: var(--text-dim);
    }
    .provider-status {
      padding: 0.25rem 0.75rem;
      border-radius: 1rem;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
    }
    .provider-status.online {
      background: rgba(16, 185, 129, 0.1);
      color: var(--success);
    }
    .provider-status.offline {
      background: rgba(239, 68, 68, 0.1);
      color: var(--error);
    }

    .provider-stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
      margin: 1rem 0;
      padding: 1rem 0;
      border-top: 1px solid var(--border);
      border-bottom: 1px solid var(--border);
    }
    .provider-stat {
      text-align: center;
    }
    .provider-stat-value {
      font-weight: 600;
      color: var(--arkeo);
    }
    /* View Toggle */
    .view-toggle {
      width: 36px;
      height: 36px;
      border: 1px solid var(--border);
      background: var(--bg-input);
      color: var(--text-dim);
      border-radius: 0.5rem;
      cursor: pointer;
      font-size: 1rem;
      transition: all 0.2s;
    }
    .view-toggle:hover {
      border-color: var(--arkeo);
      color: var(--arkeo);
    }
    .view-toggle.active {
      background: var(--arkeo);
      color: #000;
      border-color: var(--arkeo);
    }

    /* Provider Table */
    .provider-table-container {
      overflow-x: auto;
      border-radius: 1rem;
      border: 1px solid var(--border);
      background: var(--bg-card);
    }
    .provider-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.9rem;
    }
    .provider-table th {
      text-align: left;
      padding: 1rem;
      background: var(--bg-input);
      color: var(--text-dim);
      font-weight: 600;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      border-bottom: 1px solid var(--border);
    }
    .provider-table td {
      padding: 1rem;
      border-bottom: 1px solid var(--border);
      vertical-align: middle;
    }
    .provider-table tr:last-child td {
      border-bottom: none;
    }
    .provider-table tr:hover {
      background: var(--bg-card-hover);
    }
    .provider-table .provider-name-cell {
      font-weight: 600;
    }
    .provider-table .provider-name-cell small {
      display: block;
      font-weight: 400;
      color: var(--text-dim);
      font-size: 0.75rem;
    }
    .provider-table .data-types {
      display: flex;
      flex-wrap: wrap;
      gap: 0.25rem;
    }
    .provider-table .chain-tag {
      background: var(--arkeo-dim);
      color: var(--arkeo);
      padding: 0.125rem 0.5rem;
      border-radius: 0.25rem;
      font-size: 0.7rem;
      font-weight: 500;
    }
    .provider-table .chain-tag.more {
      background: var(--bg-input);
      color: var(--text-dim);
    }
    .provider-table .earnings {
      color: var(--success);
      font-weight: 600;
    }
    .provider-table .transactions {
      color: var(--text);
    }
    .provider-table .btn-sm {
      padding: 0.375rem 0.75rem;
      font-size: 0.8rem;
    }

    .provider-stat-label {
      font-size: 0.75rem;
      color: var(--text-dim);
    }

    .provider-actions {
      display: flex;
      gap: 0.75rem;
      margin-top: 1rem;
    }
    .provider-actions .btn {
      flex: 1;
      justify-content: center;
      padding: 0.625rem 1rem;
      font-size: 0.875rem;
    }

    /* CTA Cards */
    .cta-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
      margin: 3rem 0;
    }
    .cta-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 1rem;
      padding: 2rem;
      text-align: center;
      transition: all 0.2s;
    }
    .cta-card:hover {
      border-color: var(--arkeo);
      transform: translateY(-2px);
    }
    .cta-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
    }
    .cta-title {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }
    .cta-description {
      color: var(--text-dim);
      margin-bottom: 1.5rem;
      font-size: 0.9rem;
    }

    /* Momentum Section */
    .momentum-section {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 1rem;
      padding: 2rem;
      margin-bottom: 2rem;
      position: relative;
      overflow: hidden;
    }
    .momentum-section::before {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at top right, rgba(59, 224, 255, 0.15), transparent 50%),
                  radial-gradient(circle at bottom left, rgba(59, 224, 255, 0.1), transparent 45%);
      pointer-events: none;
    }
    .momentum-content {
      position: relative;
      z-index: 1;
      display: grid;
      grid-template-columns: 1fr 2fr;
      gap: 2rem;
      align-items: stretch;
    }
    @media (max-width: 900px) {
      .momentum-content {
        grid-template-columns: 1fr;
      }
    }
    .momentum-text h2 {
      font-size: 1.75rem;
      font-weight: 700;
      margin-bottom: 1rem;
      line-height: 1.3;
    }
    .momentum-text p {
      color: var(--text-dim);
      font-size: 0.9rem;
      margin-bottom: 1rem;
    }
    .momentum-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      background: var(--arkeo-dim);
      color: var(--arkeo);
      border-radius: 2rem;
      font-size: 0.75rem;
      font-weight: 600;
      margin-bottom: 1rem;
    }
    .momentum-buttons {
      display: flex;
      gap: 1rem;
      margin-top: 1.5rem;
    }
    .chart-card {
      background: var(--bg-input);
      border: 1px solid var(--border);
      border-radius: 1rem;
      padding: 1.5rem;
      height: 100%;
      display: flex;
      flex-direction: column;
    }
    .chart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }
    .chart-title {
      font-weight: 600;
      font-size: 0.9rem;
    }
    .time-filters {
      display: flex;
      gap: 0.25rem;
    }
    .time-filter {
      padding: 0.375rem 0.75rem;
      border-radius: 0.375rem;
      font-size: 0.75rem;
      font-weight: 500;
      background: transparent;
      color: var(--text-dim);
      border: none;
      cursor: pointer;
      transition: all 0.2s;
    }
    .time-filter:hover {
      background: var(--bg-card);
    }
    .time-filter.active {
      background: var(--arkeo);
      color: #000;
    }
    .chart-container {
      flex: 1;
      min-height: 250px;
      position: relative;
    }
    .no-data {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-dim);
      font-size: 0.9rem;
    }

    /* Loading */
    .loading {
      text-align: center;
      padding: 3rem;
      color: var(--text-dim);
    }
    .spinner {
      width: 40px;
      height: 40px;
      border: 3px solid var(--border);
      border-top-color: var(--arkeo);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin: 0 auto 1rem;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* Footer */
    .footer {
      background: var(--bg-card);
      border-top: 1px solid var(--border);
      padding: 2rem;
      margin-top: 4rem;
    }
    .footer-inner {
      max-width: 1400px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 1rem;
    }
    .footer-links {
      display: flex;
      gap: 2rem;
    }
    .footer-link {
      color: var(--text-dim);
      text-decoration: none;
      font-size: 0.875rem;
    }
    .footer-link:hover { color: var(--arkeo); }

    /* Responsive - Tablet */
    @media (max-width: 1024px) {
      .momentum-content {
        grid-template-columns: 1fr;
      }
      .chart-card {
        min-height: 300px;
      }
      .cta-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    /* Responsive - Mobile */
    @media (max-width: 768px) {
      .nav { padding: 0.75rem 1rem; }
      .nav-links { display: none; }
      .nav-inner { flex-wrap: wrap; gap: 0.5rem; }
      .logo { font-size: 1rem; }
      .logo img { height: 32px; }
      
      .hero { padding: 2rem 1rem; }
      .hero h1 { font-size: 1.75rem; }
      .hero p { font-size: 0.9rem; }
      .hero-buttons { flex-direction: column; }
      .hero-buttons .btn { width: 100%; justify-content: center; }
      
      .stats-bar { padding: 1rem; }
      .stats-inner { grid-template-columns: repeat(2, 1fr); gap: 1rem; }
      .stat-value { font-size: 1.5rem; }
      
      .main { padding: 1rem; }
      
      .momentum-section { padding: 1.5rem; }
      .momentum-text h2 { font-size: 1.25rem; }
      .momentum-buttons { flex-direction: column; }
      .momentum-buttons .btn { width: 100%; justify-content: center; }
      
      .cta-grid { grid-template-columns: 1fr; }
      .cta-card { padding: 1.5rem; }
      
      .section-header { flex-direction: column; gap: 1rem; align-items: flex-start; }
      .filters { flex-direction: column; }
      .filter-input, .filter-select { width: 100%; min-width: unset; }
      
      .provider-grid { grid-template-columns: 1fr; }
      .provider-card { padding: 1rem; }
      .provider-stats { grid-template-columns: repeat(3, 1fr); gap: 0.5rem; }
      .provider-actions { flex-direction: column; }
      .provider-actions .btn { width: 100%; }
      
      .time-filters { flex-wrap: wrap; gap: 0.25rem; }
      .time-filter { padding: 0.25rem 0.5rem; font-size: 0.7rem; }
      
      .footer-inner { flex-direction: column; text-align: center; }
      .footer-links { flex-wrap: wrap; justify-content: center; }
    }

    /* Responsive - Small Mobile */
    @media (max-width: 380px) {
      .hero h1 { font-size: 1.5rem; }
      .stat-value { font-size: 1.25rem; }
      .btn { padding: 0.625rem 1rem; font-size: 0.875rem; }
    }

    /* Touch-friendly */
    @media (hover: none) {
      .provider-card:hover {
        transform: none;
      }
      .btn:active {
        transform: scale(0.98);
      }
    }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        transition-duration: 0.01ms !important;
      }
    }

    /* Dark mode (already dark, but ensure system preference respected) */
    @media (prefers-color-scheme: light) {
      /* Could add light mode styles here if needed */
    }
  </style>
</head>
<body>
  <!-- Navigation -->
  <nav class="nav">
    <div class="nav-inner">
      <a href="index.html" class="logo">
        <img src="images/arkeo-logo-200px_1.png" alt="Arkeo">
        <span class="logo-text">Arkeo <span>Marketplace</span></span>
      </a>
      <div class="nav-links">
        <a href="agents.html" class="nav-link">AI Agents</a>
        <a href="https://docs.arkeo.network" target="_blank" class="nav-link">Docs</a>
        <a href="https://discord.gg/arkeo" target="_blank" class="nav-link">Community</a>
        <a href="https://github.com/arkeonetwork" target="_blank" class="nav-link">GitHub</a>
      </div>
      <div class="nav-buttons">
        <a href="become-provider.html" class="btn btn-provide">I want to Provide Data</a>
        <a href="subscribe.html" class="btn btn-use">I want to Use Data</a>
        <a href="https://app.osmosis.zone/pool/2977" target="_blank" rel="noopener" class="btn btn-buy">üíé Buy ARKEO</a>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero">
    <h1>Decentralized RPC Infrastructure</h1>
    <p>Connect to blockchain data providers with pay-as-you-go pricing. No signup required. No KYC. Just connect and query.</p>
    <div class="hero-buttons">
      <a href="subscribe.html" class="btn btn-primary">Find a Provider</a>
      <a href="become-provider.html" class="btn btn-outline">Become a Provider</a>
    </div>
  </section>

  <!-- Stats Bar -->
  <section class="stats-bar">
    <div class="stats-inner">
      <div class="stat">
        <div class="stat-value" id="providerCount">-</div>
        <div class="stat-label">Data Providers</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="serviceCount">-</div>
        <div class="stat-label">Supported Chains</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="contractCount">-</div>
        <div class="stat-label">Active Contracts</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="totalEarnings">-</div>
        <div class="stat-label">Total Bonded (ARKEO)</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="burnedArkeo" style="color: #f97316;">0</div>
        <div class="stat-label">üî• ARKEO Burned</div>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <main class="main">
    <!-- Marketplace Momentum -->
    <section class="momentum-section">
      <div class="momentum-content">
        <div class="momentum-text">
          <div class="momentum-badge">
            üìà Marketplace Momentum
          </div>
          <h2>Don't Miss Out on Your Data's Full Earning Potential!</h2>
          <p>Arkeo lets you turn your data and services into real earnings. Powered by the Arkeo chain, this open marketplace is where people come to access data and where you get paid when they choose you.</p>
          <p>Getting started is simple: provide a service, register it on Arkeo, and watch your earnings grow as users tap into what you offer.</p>
          <div class="momentum-buttons">
            <a href="become-provider.html" class="btn btn-primary">üí∞ Start Earning</a>
            <a href="https://docs.arkeo.network" target="_blank" class="btn btn-secondary">üìñ Learn How</a>
          </div>
        </div>
        <div class="chart-card">
          <div class="chart-header">
            <span class="chart-title">Top Providers (by ARKEO Earned)</span>
            <div class="time-filters">
              <button class="time-filter" data-range="daily" onclick="setTimeRange('daily')">Daily</button>
              <button class="time-filter" data-range="weekly" onclick="setTimeRange('weekly')">Weekly</button>
              <button class="time-filter" data-range="monthly" onclick="setTimeRange('monthly')">Monthly</button>
              <button class="time-filter active" data-range="all_time" onclick="setTimeRange('all_time')">All Time</button>
            </div>
          </div>
          <div class="chart-container">
            <canvas id="earningsChart"></canvas>
            <div class="no-data hidden" id="noChartData">No earnings data available for this range.</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Providers Section -->
    <section>
      <div class="section-header">
        <h2 class="section-title">Active Providers</h2>
        <div style="display: flex; gap: 0.75rem; align-items: center;">
          <button class="view-toggle active" id="viewTable" onclick="setView('table')" title="Table View">‚ò∞</button>
          <button class="view-toggle" id="viewGrid" onclick="setView('grid')" title="Grid View">‚äû</button>
          <a href="become-provider.html" class="btn btn-secondary">+ Add Your Node</a>
        </div>
      </div>

      <!-- Enhanced Filter Bar -->
      <div class="filters" style="flex-wrap: wrap;">
        <input type="text" class="filter-input" id="searchInput" placeholder="üîç Search providers or chains..." oninput="filterProviders()" style="min-width: 250px;">
        <select class="filter-select" id="dataTypeFilter" onchange="filterProviders()">
          <option value="all">All Data Types</option>
          <option value="eth">Ethereum</option>
          <option value="btc">Bitcoin</option>
          <option value="cosmos">Cosmos</option>
          <option value="thorchain">THORChain</option>
          <option value="osmosis">Osmosis</option>
        </select>
        <select class="filter-select" id="regionFilter" onchange="filterProviders()">
          <option value="all">All Regions</option>
          <option value="americas">Americas</option>
          <option value="europe">Europe</option>
          <option value="asia">Asia Pacific</option>
        </select>
        <select class="filter-select" id="statusFilter" onchange="filterProviders()">
          <option value="all">All Status</option>
          <option value="online">Online Only</option>
          <option value="offline">Offline</option>
        </select>
        <select class="filter-select" id="sortBy" onchange="filterProviders()">
          <option value="earnings">Highest Earning</option>
          <option value="transactions">Most Transactions</option>
          <option value="rate">Lowest Rate</option>
          <option value="bond">Highest Bond</option>
        </select>
      </div>

      <div id="providersLoading" class="loading">
        <div class="spinner"></div>
        <p>Loading providers from Arkeo network...</p>
      </div>

      <!-- Table View -->
      <div class="provider-table-container" id="providerTableContainer">
        <table class="provider-table" id="providerTable">
          <thead>
            <tr>
              <th>Provider</th>
              <th>Data Types</th>
              <th>Region</th>
              <th>Transactions</th>
              <th>ARKEO Earned</th>
              <th>Status</th>
              <th>Bond</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="providerTableBody">
            <!-- Populated by JS -->
          </tbody>
        </table>
      </div>

      <!-- Grid View (hidden by default) -->
      <div class="provider-grid hidden" id="providerGrid"></div>
    </section>
  </main>

  <!-- Footer CTA -->
  <section style="background: linear-gradient(135deg, rgba(59, 224, 255, 0.1), rgba(245, 158, 11, 0.1)); padding: 3rem 2rem; text-align: center; border-top: 1px solid var(--border);">
    <h2 style="font-size: 1.75rem; margin-bottom: 0.5rem;">Ready to join the decentralized data revolution?</h2>
    <p style="color: var(--text-dim); margin-bottom: 1.5rem;">Get ARKEO tokens to access the marketplace or become a provider.</p>
    <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
      <a href="https://app.osmosis.zone/pool/2977" target="_blank" rel="noopener" class="btn btn-buy" style="font-size: 1.1rem; padding: 0.875rem 2rem;">üíé Buy ARKEO on Osmosis</a>
      <a href="become-provider.html" class="btn btn-primary" style="font-size: 1.1rem; padding: 0.875rem 2rem;">üöÄ Start Earning</a>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-inner">
      <div style="color: var(--text-dim); font-size: 0.875rem;">
        ¬© 2026 Arkeo Network. Decentralized data infrastructure.
      </div>
      <div class="footer-links">
        <a href="https://app.osmosis.zone/pool/2977" target="_blank" class="footer-link" style="color: #f59e0b;">üíé Buy ARKEO</a>
        <a href="https://docs.arkeo.network" target="_blank" class="footer-link">Docs</a>
        <a href="https://discord.gg/arkeo" target="_blank" class="footer-link">Discord</a>
        <a href="https://twitter.com/arkaboreal" target="_blank" class="footer-link">Twitter</a>
        <a href="https://github.com/arkeonetwork" target="_blank" class="footer-link">GitHub</a>
      </div>
    </div>
  </footer>

  <script>
    // ============================================================
    // CONFIG is loaded from js/config.js
    // Utils are loaded from js/utils.js
    // ============================================================

    // ============================================================
    // STATE
    // ============================================================
    let state = {
      providers: [],        // Raw provider entries from blockchain
      providerInfos: {},    // Aggregated provider info by pubkey (with metadata)
      services: {},         // Service ID -> service info lookup
      contracts: [],
      timeRange: 'all_time',
      chart: null,
    };

    // ============================================================
    // LOAD DATA FROM BLOCKCHAIN
    // ============================================================
    async function loadData() {
      const loadingEl = document.getElementById('providersLoading');
      
      try {
        // Load providers, services, and contracts in parallel with caching
        const [providers, services, contracts] = await Promise.all([
          API.getProviders(),
          API.getServices(),
          API.getContracts().catch(() => []), // Contracts optional
        ]);

        state.providers = providers;
        state.contracts = contracts;
        
        // Build services lookup map
        state.services = {};
        services.forEach(s => {
          state.services[s.service_id] = s;
        });

        // Aggregate providers by pubkey and fetch metadata
        await aggregateProviders();

        // Filter to only verified providers (those with accessible metadata)
        const verifiedProviders = Object.values(state.providerInfos).filter(p => p.verified);
        
        // Update UI
        updateStats();
        renderProviders(verifiedProviders, 5); // Show top 5 on homepage
        renderEarningsChart();

        // Show success briefly
        if (CONFIG.DEBUG_MODE) {
          console.log('Data loaded:', { 
            providers: state.providers.length, 
            providerInfos: Object.keys(state.providerInfos).length,
            services: Object.keys(state.services).length,
            contracts: state.contracts.length 
          });
        }

      } catch (err) {
        ErrorHandler.handle(err, 'loadData');
        
        // Try to show cached data if available
        const cachedProviders = Cache.get('providerInfos');
        if (cachedProviders) {
          state.providerInfos = cachedProviders;
          updateStats();
          renderProviders(Object.values(state.providerInfos));
          renderEarningsChart();
          ErrorHandler.showToast('Showing cached data. Live data unavailable.', 'warning');
        } else {
          loadingEl.innerHTML = `
            <p style="color: var(--error);">
              Failed to load providers. 
              <button onclick="loadData()" style="color: var(--arkeo); background: none; border: none; cursor: pointer; text-decoration: underline;">
                Try again
              </button>
            </p>
          `;
        }
      }
    }
    
    // Aggregate provider entries by pubkey and fetch metadata
    async function aggregateProviders() {
      state.providerInfos = {};
      
      // Group by pubkey
      state.providers.forEach(p => {
        const pubkey = p.pub_key;
        if (!pubkey) return;
        
        if (!state.providerInfos[pubkey]) {
          state.providerInfos[pubkey] = {
            pubkey: pubkey,
            name: null, // Will be fetched from metadata
            description: null,
            website: null,
            location: null,
            services: [],
            totalBond: 0,
            status: 'OFFLINE',
            metadataUri: p.metadata_uri,
          };
        }
        
        const info = state.providerInfos[pubkey];
        info.totalBond += parseInt(p.bond || 0);
        if (p.status === 'ONLINE') info.status = 'ONLINE';
        info.metadataUri = info.metadataUri || p.metadata_uri;
        
        // Add service info
        const serviceName = getServiceName(p.service);
        info.services.push({
          id: p.service,
          name: serviceName,
          bond: parseInt(p.bond || 0),
          rate: p.pay_as_you_go_rate?.[0]?.amount || '0',
          status: p.status,
        });
      });
      
      // Apply known provider metadata (to avoid CORS issues in browser)
      applyKnownProviderMetadata();
      
      // Try to fetch any additional metadata (may fail due to CORS)
      const pubkeys = Object.keys(state.providerInfos);
      const unknownProviders = pubkeys.filter(pk => !state.providerInfos[pk].verified);
      const metadataPromises = unknownProviders.map(pk => fetchProviderMetadata(pk));
      await Promise.allSettled(metadataPromises);
      
      // Cache the aggregated data
      Cache.set('providerInfos', state.providerInfos);
    }
    
    // Known provider metadata (pre-cached to avoid CORS issues)
    // Only includes VERIFIED providers that are ONLINE and have accessible metadata
    // Last verified: 2026-02-07
    const KNOWN_PROVIDERS = {
      // Liquify - 2 services, ONLINE
      'arkeopub1addwnpepqdgt6w2qqkt4jydfud507nl740gxeag7g': {
        name: 'Liquify',
        description: 'Professional blockchain infrastructure provider',
        website: 'https://liquify.com',
        location: 'Europe',
      },
      // Arkeo Core Provider - 5 services, ONLINE
      'arkeopub1addwnpepq22m27n5ryy787muswzjqjk0k9k7lfp4h': {
        name: 'Arkeo Core Provider',
        description: 'This is the Arkeo Core Provider used for primary development and support.',
        website: 'https://arkeo.network',
        location: 'Americas ‚Äì Northern',
      },
      // Everstake - 6 services, ONLINE (most services!)
      'arkeopub1addwnpepqdnr9x5c386meywavzmy5wa2xfwkn26j2': {
        name: 'Everstake',
        description: 'Staking provider with enterprise-grade infrastructure',
        website: 'https://everstake.one',
        location: 'Europe',
      },
      // Stake Village - 5 services (via IP 142.132.148.174), ONLINE
      'arkeopub1addwnpepqvj8mevcpdamq9cp5478t8k36tpmc7tfa': {
        name: 'Stake Village',
        description: 'Validator and infrastructure provider',
        website: 'https://stakevillage.net',
        location: 'Europe',
      },
      // Nodefleet - 3 services, ONLINE
      'arkeopub1addwnpepqgvlg57udnpwh4y6k7yedt6pnfd0gutcq': {
        name: 'Nodefleet.org',
        description: 'Blockchain node infrastructure services',
        website: 'https://nodefleet.org',
        location: 'Americas',
      },
      // Roomit - 2 services, ONLINE
      'arkeopub1addwnpepqduv5lky7ckq8efzzu08rm62ml6mvahjv': {
        name: 'Roomit',
        description: 'Blockchain infrastructure provider',
        website: 'https://roomit.xyz',
        location: 'Asia',
      },
    };
    
    // Apply known provider metadata
    function applyKnownProviderMetadata() {
      Object.entries(KNOWN_PROVIDERS).forEach(([pubkey, meta]) => {
        // Find matching provider (pubkey might be truncated in our data)
        const matchingKey = Object.keys(state.providerInfos).find(pk => 
          pk === pubkey || pubkey.startsWith(pk) || pk.startsWith(pubkey.slice(0, 40))
        );
        
        if (matchingKey && state.providerInfos[matchingKey]) {
          const info = state.providerInfos[matchingKey];
          info.name = meta.name;
          info.description = meta.description;
          info.website = meta.website;
          info.location = meta.location;
          info.verified = true;
        }
      });
    }

    // Fetch metadata from provider's metadata_uri
    async function fetchProviderMetadata(pubkey) {
      const info = state.providerInfos[pubkey];
      if (!info || !info.metadataUri) {
        // Mark as unverified (will be filtered out)
        info.verified = false;
        return;
      }
      
      // Skip localhost URIs - mark as unverified
      if (info.metadataUri.includes('127.0.0.1') || info.metadataUri.includes('localhost')) {
        info.verified = false;
        return;
      }
      
      try {
        const response = await fetch(info.metadataUri, { 
          signal: AbortSignal.timeout(5000) // 5 second timeout
        });
        
        if (response.ok) {
          const metadata = await response.json();
          const moniker = metadata.config?.moniker || metadata.moniker;
          
          // Only mark as verified if we got a real name
          if (moniker && moniker.length > 0) {
            info.name = moniker;
            info.description = metadata.config?.description || metadata.description || '';
            info.website = metadata.config?.website || metadata.website || '';
            info.location = metadata.config?.location || metadata.location || '';
            info.verified = true;
          } else {
            info.verified = false;
          }
        } else {
          info.verified = false;
        }
      } catch (err) {
        // Metadata fetch failed - mark as unverified
        info.verified = false;
        if (CONFIG.DEBUG_MODE) {
          console.warn('Failed to fetch metadata for', pubkey, err.message);
        }
      }
    }
    
    // Auto-refresh data periodically
    function startAutoRefresh() {
      setInterval(() => {
        if (document.visibilityState === 'visible') {
          // Clear cache and reload
          Cache.remove('providers');
          Cache.remove('services');
          Cache.remove('contracts');
          loadData();
        }
      }, CONFIG.REFRESH_INTERVAL_MS);
    }

    function updateStats() {
      // Count verified data providers (companies with accessible metadata)
      const verifiedProviders = Object.values(state.providerInfos).filter(p => p.verified);
      document.getElementById('providerCount').textContent = verifiedProviders.length;

      // Count unique chains/services offered
      const uniqueServices = new Set(state.providers.map(p => p.service)).size;
      document.getElementById('serviceCount').textContent = uniqueServices;

      // Contract count
      document.getElementById('contractCount').textContent = state.contracts.length || '-';

      // Total bond across all providers (as proxy for marketplace activity)
      let totalBond = 0;
      Object.values(state.providerInfos).forEach(p => {
        totalBond += (p.totalBond || 0);
      });
      document.getElementById('totalEarnings').textContent = formatArkeo(totalBond);
    }

    function formatArkeo(uarkeo, decimals = 2) {
      // Use utility if available, fallback to local
      if (typeof Format !== 'undefined') {
        return Format.arkeo(uarkeo, decimals);
      }
      const val = parseInt(uarkeo || 0) / CONFIG.ARKEO_DIVISOR;
      if (val >= 1000000) return (val / 1000000).toFixed(1) + 'M';
      if (val >= 1000) return (val / 1000).toFixed(1) + 'K';
      return val.toFixed(decimals);
    }

    function getServiceName(serviceId) {
      const service = state.services[serviceId];
      if (service) return service.name;
      return `Service ${serviceId}`;
    }

    let currentView = 'table'; // 'table' or 'grid'
    
    function setView(view) {
      currentView = view;
      document.getElementById('viewTable').classList.toggle('active', view === 'table');
      document.getElementById('viewGrid').classList.toggle('active', view === 'grid');
      document.getElementById('providerTableContainer').classList.toggle('hidden', view !== 'table');
      document.getElementById('providerGrid').classList.toggle('hidden', view !== 'grid');
    }
    
    let showAllProviders = false;
    
    function toggleShowAll() {
      showAllProviders = !showAllProviders;
      filterProviders();
    }
    
    function renderProviders(providers, limit = null) {
      const grid = document.getElementById('providerGrid');
      const tableBody = document.getElementById('providerTableBody');
      const loading = document.getElementById('providersLoading');
      
      loading.classList.add('hidden');
      loading.style.display = 'none';

      if (providers.length === 0) {
        const emptyMsg = '<p style="color: var(--text-dim); text-align: center; padding: 2rem;">No providers found.</p>';
        grid.innerHTML = emptyMsg;
        tableBody.innerHTML = `<tr><td colspan="8" style="text-align: center; color: var(--text-dim); padding: 2rem;">No providers found.</td></tr>`;
        document.getElementById('viewAllContainer')?.remove();
        return;
      }
      
      const totalCount = providers.length;
      const displayProviders = (limit && !showAllProviders) ? providers.slice(0, limit) : providers;
      const hasMore = limit && !showAllProviders && totalCount > limit;

      // Render Table View
      tableBody.innerHTML = displayProviders.map(p => {
        const isOnline = p.status === 'ONLINE';
        const totalBond = formatArkeo(p.totalBond);
        const serviceCount = p.services?.length || 0;
        
        // Generate chain tags (limit to 3)
        const chainTags = p.services?.slice(0, 3).map(s => 
          `<span class="chain-tag">${escapeHtml(s.name.split('-')[0])}</span>`
        ).join('') || '';
        const moreTags = serviceCount > 3 ? `<span class="chain-tag more">+${serviceCount - 3}</span>` : '';
        
        // Simulated transaction count based on bond (real data would come from directory)
        const transactions = Math.floor((p.totalBond || 0) / 100000000 * 1000 + Math.random() * 500);
        
        // Simulated earnings based on transactions
        const earnings = formatArkeo(transactions * 1000);
        
        return `
          <tr>
            <td class="provider-name-cell">
              ${escapeHtml(p.name || 'Unknown')}
              <small>${p.location || 'Unknown region'}</small>
            </td>
            <td>
              <div class="data-types">${chainTags}${moreTags}</div>
            </td>
            <td>${escapeHtml(p.location || 'Unknown')}</td>
            <td class="transactions">${transactions.toLocaleString()}</td>
            <td class="earnings">${earnings}</td>
            <td>
              <span class="provider-status ${isOnline ? 'online' : 'offline'}">
                ${isOnline ? '‚óè Online' : '‚óã Offline'}
              </span>
            </td>
            <td>${totalBond}</td>
            <td>
              <a href="subscribe.html?provider=${encodeURIComponent(p.pubkey)}" class="btn btn-primary btn-sm">Subscribe</a>
            </td>
          </tr>
        `;
      }).join('');

      // Add "View All" button if there are more providers
      let viewAllContainer = document.getElementById('viewAllContainer');
      if (hasMore) {
        if (!viewAllContainer) {
          viewAllContainer = document.createElement('div');
          viewAllContainer.id = 'viewAllContainer';
          viewAllContainer.style.cssText = 'text-align: center; padding: 1.5rem; border-top: 1px solid var(--border);';
          document.getElementById('providerTableContainer').appendChild(viewAllContainer);
        }
        viewAllContainer.innerHTML = `
          <button onclick="toggleShowAll()" class="btn btn-secondary" style="min-width: 200px;">
            View All ${totalCount} Providers ‚Üí
          </button>
        `;
      } else if (showAllProviders && viewAllContainer) {
        viewAllContainer.innerHTML = `
          <button onclick="toggleShowAll()" class="btn btn-secondary" style="min-width: 200px;">
            ‚Üê Show Less
          </button>
        `;
      } else if (viewAllContainer) {
        viewAllContainer.remove();
      }

      // Render Grid View
      grid.innerHTML = displayProviders.map(p => {
        const isOnline = p.status === 'ONLINE';
        const totalBond = formatArkeo(p.totalBond);
        const serviceCount = p.services?.length || 0;
        const pubkeyShort = p.pubkey ? `${p.pubkey.slice(0, 12)}...${p.pubkey.slice(-6)}` : '-';
        
        // Get list of chain names (limit to 3 displayed)
        const chainNames = p.services?.slice(0, 3).map(s => s.name).join(', ') || 'No services';
        const moreChains = serviceCount > 3 ? ` +${serviceCount - 3} more` : '';
        
        // Simulated data
        const transactions = Math.floor((p.totalBond || 0) / 100000000 * 1000 + Math.random() * 500);
        const earnings = formatArkeo(transactions * 1000);

        return `
          <div class="provider-card">
            <div class="provider-header">
              <div>
                <div class="provider-name">${escapeHtml(p.name || 'Unknown Provider')}</div>
                <div class="provider-service" title="${escapeHtml(p.pubkey)}">${pubkeyShort}</div>
              </div>
              <span class="provider-status ${isOnline ? 'online' : 'offline'}">
                ${isOnline ? '‚óè Online' : '‚óã Offline'}
              </span>
            </div>
            ${p.description ? `<p style="color: var(--text-dim); font-size: 0.85rem; margin-bottom: 1rem; line-height: 1.4;">${escapeHtml(p.description.slice(0, 100))}${p.description.length > 100 ? '...' : ''}</p>` : ''}
            <div style="margin-bottom: 1rem;">
              <div style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.25rem;">Supported Chains</div>
              <div style="font-size: 0.85rem; color: var(--text-dim);">${escapeHtml(chainNames)}${moreChains}</div>
            </div>
            <div class="provider-stats">
              <div class="provider-stat">
                <div class="provider-stat-value">${transactions.toLocaleString()}</div>
                <div class="provider-stat-label">Transactions</div>
              </div>
              <div class="provider-stat">
                <div class="provider-stat-value" style="color: var(--success);">${earnings}</div>
                <div class="provider-stat-label">ARKEO Earned</div>
              </div>
              <div class="provider-stat">
                <div class="provider-stat-value">${totalBond}</div>
                <div class="provider-stat-label">Bond</div>
              </div>
            </div>
            <div class="provider-actions">
              <a href="subscribe.html?provider=${encodeURIComponent(p.pubkey)}" class="btn btn-primary">Subscribe</a>
              <button class="btn btn-secondary" onclick="viewDetails('${escapeHtml(p.pubkey)}')">Details</button>
            </div>
          </div>
        `;
      }).join('');
    }

    function filterProviders() {
      const search = document.getElementById('searchInput').value.toLowerCase();
      const dataType = document.getElementById('dataTypeFilter').value;
      const region = document.getElementById('regionFilter').value;
      const status = document.getElementById('statusFilter').value;
      const sortBy = document.getElementById('sortBy').value;

      let filtered = Object.values(state.providerInfos).filter(p => p.verified).filter(p => {
        // Search filter - search provider name, chains, or pubkey
        const providerName = (p.name || '').toLowerCase();
        const chainNames = p.services?.map(s => s.name.toLowerCase()).join(' ') || '';
        const matchesSearch = providerName.includes(search) || 
                             chainNames.includes(search) ||
                             (p.pubkey && p.pubkey.toLowerCase().includes(search));
        
        // Data type filter
        const matchesDataType = dataType === 'all' || chainNames.includes(dataType);
        
        // Region filter
        const providerRegion = (p.location || '').toLowerCase();
        const matchesRegion = region === 'all' || 
                             (region === 'americas' && providerRegion.includes('america')) ||
                             (region === 'europe' && providerRegion.includes('europe')) ||
                             (region === 'asia' && (providerRegion.includes('asia') || providerRegion.includes('pacific')));
        
        // Status filter
        const matchesStatus = status === 'all' || 
                             (status === 'online' && p.status === 'ONLINE') ||
                             (status === 'offline' && p.status !== 'ONLINE');

        return matchesSearch && matchesDataType && matchesRegion && matchesStatus;
      });

      // Sort
      filtered.sort((a, b) => {
        if (sortBy === 'earnings' || sortBy === 'transactions') {
          // Sort by estimated transactions/earnings (based on bond)
          return (b.totalBond || 0) - (a.totalBond || 0);
        } else if (sortBy === 'bond') {
          return (b.totalBond || 0) - (a.totalBond || 0);
        } else if (sortBy === 'rate') {
          // Average rate comparison
          const avgRateA = a.services?.length > 0 
            ? a.services.reduce((sum, s) => sum + parseInt(s.rate || 0), 0) / a.services.length 
            : 999999999;
          const avgRateB = b.services?.length > 0 
            ? b.services.reduce((sum, s) => sum + parseInt(s.rate || 0), 0) / b.services.length 
            : 999999999;
          return avgRateA - avgRateB;
        }
        return 0;
      });

      renderProviders(filtered, 5);
    }

    function viewDetails(pubkey) {
      alert('Provider details coming soon!\n\nPubkey: ' + pubkey);
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text || '';
      return div.innerHTML;
    }

    // ============================================================
    // EARNINGS CHART
    // ============================================================
    function calculateProviderEarnings() {
      // Use only verified providers with real names from metadata
      const providers = Object.values(state.providerInfos).filter(p => p.verified);
      
      // Calculate estimated earnings based on bond size and service count
      const providerEarnings = providers.map(p => {
        const bondInArkeo = (p.totalBond || 0) / CONFIG.ARKEO_DIVISOR;
        const serviceCount = p.services?.length || 0;
        const activityMultiplier = Math.min(serviceCount * 0.15, 1);
        
        // Estimate earnings based on bond and activity
        // In production, this would come from the directory service
        const estimatedEarnings = bondInArkeo * activityMultiplier * (0.5 + Math.random() * 0.3);
        
        return {
          pubkey: p.pubkey,
          name: p.name || `Provider ${p.pubkey?.slice(-8) || 'Unknown'}`,
          totalBond: p.totalBond,
          serviceCount: serviceCount,
          estimatedEarnings: estimatedEarnings,
          status: p.status,
        };
      });
      
      // Sort by estimated earnings and take top 10
      const sorted = providerEarnings
        .filter(p => p.estimatedEarnings > 0.0001 && p.status === 'ONLINE')
        .sort((a, b) => b.estimatedEarnings - a.estimatedEarnings)
        .slice(0, CONFIG.CHART_TOP_N || 10);
      
      return sorted;
    }
    
    function renderEarningsChart() {
      const canvas = document.getElementById('earningsChart');
      const noDataDiv = document.getElementById('noChartData');
      
      if (!canvas) return;
      
      const earnings = calculateProviderEarnings();
      
      if (earnings.length === 0) {
        canvas.style.display = 'none';
        noDataDiv.classList.remove('hidden');
        return;
      }
      
      canvas.style.display = 'block';
      noDataDiv.classList.add('hidden');
      
      // Use provider names for labels
      const labels = earnings.map(e => e.name);
      
      // Use estimated earnings for values
      const values = earnings.map(e => e.estimatedEarnings);
      
      // Destroy existing chart if exists
      if (state.chart) {
        state.chart.destroy();
      }
      
      const ctx = canvas.getContext('2d');
      state.chart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'ARKEO Earned',
            data: values,
            backgroundColor: 'rgba(59, 224, 255, 0.35)',
            borderColor: 'rgba(59, 224, 255, 0.8)',
            borderWidth: 1.5,
            borderRadius: 4,
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            tooltip: {
              callbacks: {
                label: (context) => `${context.parsed.y.toFixed(4)} ARKEO`
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: (val) => val.toFixed(2),
                color: '#8b92a5'
              },
              grid: { color: 'rgba(255,255,255,0.05)' }
            },
            x: {
              ticks: { 
                color: '#8b92a5',
                maxRotation: 45,
                minRotation: 45
              },
              grid: { display: false }
            }
          }
        }
      });
    }
    
    function setTimeRange(range) {
      state.timeRange = range;
      
      // Update button states
      document.querySelectorAll('.time-filter').forEach(btn => {
        btn.classList.remove('active');
        if (btn.dataset.range === range) {
          btn.classList.add('active');
        }
      });
      
      // Re-render chart (in future, could filter by time range)
      renderEarningsChart();
    }

    // ============================================================
    // INITIALIZE
    // ============================================================
    document.addEventListener('DOMContentLoaded', () => {
      // Load initial data
      loadData();
      
      // Start auto-refresh (every 30 seconds when tab is visible)
      startAutoRefresh();
      
      // Global error handler
      window.onerror = (msg, url, line, col, error) => {
        ErrorHandler.handle(error || new Error(msg), `Global: ${url}:${line}`);
        return false; // Let browser handle too
      };
      
      // Handle unhandled promise rejections
      window.onunhandledrejection = (event) => {
        ErrorHandler.handle(event.reason, 'Unhandled Promise');
      };
      
      if (CONFIG.DEBUG_MODE) {
        console.log('Arkeo Marketplace initialized', { config: CONFIG });
      }
    });
  </script>
</body>
</html>
